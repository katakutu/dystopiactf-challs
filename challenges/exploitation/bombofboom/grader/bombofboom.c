#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

void print_banner()
{
    puts("██████╗  ██████╗ ███╗   ███╗██████╗      ██████╗ ███████╗    ██████╗  ██████╗  ██████╗ ███╗   ███╗");
    puts("██╔══██╗██╔═══██╗████╗ ████║██╔══██╗    ██╔═══██╗██╔════╝    ██╔══██╗██╔═══██╗██╔═══██╗████╗ ████║");
    puts("██████╔╝██║   ██║██╔████╔██║██████╔╝    ██║   ██║█████╗      ██████╔╝██║   ██║██║   ██║██╔████╔██║");
    puts("██╔══██╗██║   ██║██║╚██╔╝██║██╔══██╗    ██║   ██║██╔══╝      ██╔══██╗██║   ██║██║   ██║██║╚██╔╝██║");
    puts("██████╔╝╚██████╔╝██║ ╚═╝ ██║██████╔╝    ╚██████╔╝██║         ██████╔╝╚██████╔╝╚██████╔╝██║ ╚═╝ ██║");
    puts("╚═════╝  ╚═════╝ ╚═╝     ╚═╝╚═════╝      ╚═════╝ ╚═╝         ╚═════╝  ╚═════╝  ╚═════╝ ╚═╝     ╚═╝");

}

void explode()
{
    puts("                                                                   ");
    puts("                                      _ ._  _ , _ ._               ");
    puts("                                                                   ");
    puts("                                    (_ ' ( `  )_  .__)             ");
    puts("                                 ( (  (    )   `)  ) _)            ");
    puts("                                (__ (_   (_ . _) _) ,__)           ");
    puts("                                      `~~`\\ ' . /`~~`             ");
    puts("                                      ,::: ;   ; :::,              ");
    puts("                                     ':::::::::::::::'             ");
    puts("                                __________/_ __ \\____________     ");
    puts("                                ____________BOOM!_____________     ");
    puts("                                                                   ");
    puts("                                                                   ");
}

void print_flag()
{
    char c;
    FILE *fp = fopen("flag.txt", "r");

    if (fp == NULL) {
        perror("flag.txt not present.\n");
        exit(EXIT_FAILURE);
    }

    printf("Congrats you defused the bomb. You get to live.\n");

    while((c = fgetc(fp)) != EOF) {
        printf("%c", c);
    }

    fflush(stdout);
    fclose(fp);
}


int main()
{
    print_banner();

    srand(time(NULL));

    int secret = rand() % 1000000;
    char input[20];

    puts("*----------------------------------------------------------------------------------------------*");
    puts("*           YOU HAVE TWO TRIES TO DEFUSE THE BOMB. WE BELIEVE IN SECOND CHANCES!  ^_^          *");
    puts("*                            [ HINT: CODE IS BETWEEN 0 - 999999 ]                              *");
    puts("*----------------------------------------------------------------------------------------------*");
    fflush(stdout);

    for (int i = 0; i < 2; i++)  {
        printf("[+] ENTER CODE => ");
        fflush(stdout);
        fgets(input, 20, stdin);

        printf("[+] ENTERING THE CODE: ");
        printf(input);
        printf("\n\n");
        fflush(stdout);

        if (atoi(input) == secret) {
            print_flag();
            return 0;
        }
    }

    explode();
    printf("                          [THE CORRECT CODE WAS %d. YOU WERE WRONG.]\n", secret);
    fflush(stdout);

    return 0;
}
